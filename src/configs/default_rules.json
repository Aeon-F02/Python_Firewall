import json

def load_default_rules(rules_file="default_rules.json"):
    try:
        with open(rules_file, "r") as file:
            rules = json.load(file)
            return rules
    except FileNotFoundError:
        print(f"Rules file '{rules_file}' not found. Starting with no rules.")
        return []

def save_default_rules(rules_file="default_rules.json", rules=None):
    if rules is None:
        rules = []
    with open(rules_file, "w") as file:
        json.dump(rules, file, indent=4)
        print(f"Saved rules to '{rules_file}'")

if __name__ == "__main__":
    # Example Usage
    rules = load_default_rules()
    print("Loaded Rules:", rules)

    # Add a sample rule and save
    rules.append({"src": "172.16.0.1", "action": "BLOCK"})
    save_default_rules(rules=rules)
